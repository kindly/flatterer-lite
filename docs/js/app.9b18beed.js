(function(e){function t(t){for(var n,r,o=t[0],l=t[1],c=t[2],u=0,p=[];u<o.length;u++)r=o[u],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&p.push(s[r][0]),s[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);d&&d(t);while(p.length)p.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,r=1;r<a.length;r++){var l=a[r];0!==s[l]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},s={app:0},i=[];function r(e){return o.p+"js/"+({about:"about"}[e]||e)+"."+{about:"74233075"}[e]+".js"}function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.e=function(e){var t=[],a=s[e];if(0!==a)if(a)t.push(a[2]);else{var n=new Promise((function(t,n){a=s[e]=[t,n]}));t.push(a[2]=n);var i,l=document.createElement("script");l.charset="utf-8",l.timeout=120,o.nc&&l.setAttribute("nonce",o.nc),l.src=r(e);var c=new Error;i=function(t){l.onerror=l.onload=null,clearTimeout(u);var a=s[e];if(0!==a){if(a){var n=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+n+": "+i+")",c.name="ChunkLoadError",c.type=n,c.request=i,a[1](c)}s[e]=void 0}};var u=setTimeout((function(){i({type:"timeout",target:l})}),12e4);l.onerror=l.onload=i,document.head.appendChild(l)}return Promise.all(t)},o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/",o.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var d=c;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-app",[a("v-navigation-drawer",{attrs:{app:"",width:"350"}},[a("v-list-item",{attrs:{to:"/"}},[a("v-list-item-content",[a("img",{staticStyle:{flex:"none"},attrs:{width:"150",src:"https://raw.githubusercontent.com/kindly/flatterer/main/docs/_static/flatterer-with-inline-text.svg"}})])],1),a("v-divider"),a("v-list-item",{attrs:{to:"about"}},[a("v-list-item-content",[a("v-list-item-title",{staticClass:"subtitle-1"},[e._v(" About ")])],1)],1),a("v-divider"),a("v-list",{attrs:{dense:"",nav:""},model:{value:e.listItem,callback:function(t){e.listItem=t},expression:"listItem"}},["Home"==e.$route.name?a("v-list-item-group",{model:{value:e.listItem,callback:function(t){e.listItem=t},expression:"listItem"}},[a("v-list-item",{attrs:{dense:"",href:"#json-input",value:"json-input"}},[e._v(" JSON Input ")]),a("v-list-item",{attrs:{dense:"",href:"#options",value:"options"}},[e._v(" Options ")]),e.sections.error?a("v-list-item",{attrs:{dense:"",href:"#error",value:"error"}},[e._v("Error")]):e._e(),e.sections.error?a("v-list-item",{attrs:{dense:"",href:"#input-data-preview",value:"input-data-preview"}},[e._v("Input Data Preview")]):e._e(),e.sections.tables?a("v-list-item",{attrs:{dense:"",href:"#tables-preview",value:"tables-preview"}},[e._v("Tables")]):e._e(),e._l(e.sections.tables,(function(t){return a("v-list-item",{key:t,staticClass:"body-2 pl-10",staticStyle:{"min-height":"10px"},attrs:{dense:"",value:"table-"+t,href:"#table-"+t}},[e._v(e._s(t))])})),e.sections.tables?a("v-list-item",{attrs:{dense:"",href:"#download",value:"download"}},[e._v("Table Downloads")]):e._e()],2):e._e()],1)],1),a("v-main",[a("router-view")],1)],1)},i=[],r={name:"App",computed:{sections:function(){return this.$store.state.sections},listItem:{get:function(){return this.$store.state.listItem},set:function(e){this.$store.commit("setListItem",e)}}},data:function(){return{}}},o=r,l=a("2877"),c=a("6544"),u=a.n(c),d=a("7496"),p=a("ce7e"),v=a("8860"),f=a("da13"),m=a("5d23"),h=a("1baa"),b=a("f6c4"),_=a("f774"),w=Object(l["a"])(o,s,i,!1,null,null,null),x=w.exports;u()(w,{VApp:d["a"],VDivider:p["a"],VList:v["a"],VListItem:f["a"],VListItemContent:m["a"],VListItemGroup:h["a"],VListItemTitle:m["b"],VMain:b["a"],VNavigationDrawer:_["a"]});a("d3b7"),a("3ca3"),a("ddb0");var y=a("8c4f"),g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-container",[a("v-card",[a("v-row",[a("v-col",[a("v-card-title",{directives:[{name:"intersect",rawName:"v-intersect",value:e.onIntersect,expression:"onIntersect"}],attrs:{id:"json-input"}},[e._v("JSON Input")])],1),a("v-col",[a("v-container",[a("v-btn",{staticClass:"float-right",attrs:{color:"deep-orange lighten-4",disabled:"new"===e.formState},on:{click:e.reset}},[e._v("reset all")])],1)],1)],1),a("v-container",[a("v-expansion-panels",{model:{value:e.panel,callback:function(t){e.panel=t},expression:"panel"}},[a("v-expansion-panel",[a("v-expansion-panel-header",[e._v("Upload File")]),a("v-expansion-panel-content",[a("v-file-input",{attrs:{label:"File input",id:"file-input",name:"file",outlined:"",dense:"",required:""},model:{value:e.fileUpload,callback:function(t){e.fileUpload=t},expression:"fileUpload"}})],1)],1),a("v-expansion-panel",[a("v-expansion-panel-header",[e._v("Download from URL")]),a("v-expansion-panel-content",[a("v-text-field",{attrs:{outlined:"",label:"URL of JSON file",dense:"",placeholder:"https://link/to/file.json"},model:{value:e.url,callback:function(t){e.url=t},expression:"url"}})],1)],1),a("v-expansion-panel",[a("v-expansion-panel-header",[e._v("Paste")]),a("v-expansion-panel-content",[a("v-textarea",{attrs:{outlined:"",label:"JSON data"},model:{value:e.paste,callback:function(t){e.paste=t},expression:"paste"}})],1)],1)],1)],1),a("v-container",[a("v-card",[a("v-container",[a("v-row",[a("v-col",[a("h3",{directives:[{name:"intersect",rawName:"v-intersect",value:e.onIntersect,expression:"onIntersect"}],attrs:{id:"options"}},[e._v("Options")])])],1),a("v-row",{staticClass:"mt-0"},[a("v-col",[a("v-radio-group",{staticClass:"mt-0",attrs:{row:"",mandatory:"",dense:"",messages:"Position where main data array exists."},scopedSlots:e._u([{key:"label",fn:function(){return[a("strong",[e._v("Position in JSON:")])]},proxy:!0}]),model:{value:e.arrayPosition,callback:function(t){e.arrayPosition=t},expression:"arrayPosition"}},[a("v-radio",{attrs:{label:"Object or Array",value:"top"}}),a("v-radio",{attrs:{label:"JSON stream",value:"stream"}}),a("v-radio",{attrs:{label:"Array in object",value:"nested"}})],1)],1),a("v-col",[a("v-text-field",{style:{visibility:"nested"==e.arrayPosition?"visible":"hidden"},attrs:{outlined:"",dense:"",label:"Key in object of data array",messages:"The key in the object where the main array of objects exists."},model:{value:e.array_key,callback:function(t){e.array_key=t},expression:"array_key"}})],1)],1),a("v-row",[a("v-col",[a("v-text-field",{attrs:{outlined:"",dense:"",messages:"Table name that represents main data array in input.  Defaults to `main`.",label:"Main Table Name",placeholder:"main"},model:{value:e.main_table_name,callback:function(t){e.main_table_name=t},expression:"main_table_name"}})],1),a("v-col",[a("v-checkbox",{attrs:{outlined:"",dense:"","hide-details":"true",label:"Inline arrays with only single item"},model:{value:e.inline_one_to_one,callback:function(t){e.inline_one_to_one=t},expression:"inline_one_to_one"}})],1)],1),a("v-row",[a("v-col",[a("v-text-field",{attrs:{outlined:"",dense:"",messages:"Text prefixed to all output table names.  Defaults to no prefix.",label:"Table Prefix"},model:{value:e.table_prefix,callback:function(t){e.table_prefix=t},expression:"table_prefix"}})],1),a("v-col",[a("v-text-field",{attrs:{outlined:"",dense:"",label:"Path Separator",placeholder:"_",messages:"Separator between each part of the output field and table name. Defaults to `_`."},model:{value:e.path_separator,callback:function(t){e.path_separator=t},expression:"path_separator"}})],1),a("v-col",[a("v-text-field",{attrs:{outlined:"",dense:"",label:"Pushdown",placeholder:"id",messages:"Field to pushdown to seperate tables"},model:{value:e.pushdown,callback:function(t){e.pushdown=t},expression:"pushdown"}})],1)],1),2!=e.panel?a("v-row",[a("v-col",[a("v-file-input",{attrs:{label:"fields.csv file",id:"fields-file",name:"fields",outlined:"",dense:"",required:""},model:{value:e.fieldsUpload,callback:function(t){e.fieldsUpload=t},expression:"fieldsUpload"}})],1),a("v-col",[a("v-checkbox",{attrs:{outlined:"",dense:"","hide-details":"true",label:"Only output fields in file"},model:{value:e.fields_only,callback:function(t){e.fields_only=t},expression:"fields_only"}})],1),a("v-col",[a("v-file-input",{attrs:{label:"tables.csv file",id:"tables-file",name:"tables",outlined:"",dense:"",required:""},model:{value:e.tablesUpload,callback:function(t){e.tablesUpload=t},expression:"tablesUpload"}})],1),a("v-col",[a("v-checkbox",{attrs:{outlined:"",dense:"","hide-details":"true",label:"Only output tables in file"},model:{value:e.tables_only,callback:function(t){e.tables_only=t},expression:"tables_only"}})],1)],1):e._e()],1)],1)],1),a("v-container",[a("v-btn",{attrs:{color:"success",disabled:e.submitButtonDisabled||"submitted"==e.formState},on:{click:e.preview}},[e._v(e._s(e.submitButtonText))]),e.apiStatus||"submitted"!=e.formState?e._e():a("v-progress-circular",{staticClass:"ml-4",attrs:{indeterminate:"",color:"grey"}})],1)],1),e.apiError?a("v-card",{directives:[{name:"intersect",rawName:"v-intersect",value:e.onIntersect,expression:"onIntersect"}],staticClass:"mt-4",attrs:{id:"error"}},[a("v-alert",{attrs:{prominent:"",type:"error"}},[e._v(" Error processing data: "),a("br"),a("strong",[e._v(" "+e._s(e.apiError)+" ")]),a("br"),e._v(" Try again with different options or data. ")])],1):e._e(),e.fileStart?a("v-card",{staticClass:"mt-4"},[a("v-card-title",{directives:[{name:"intersect",rawName:"v-intersect",value:e.onIntersect,expression:"onIntersect"}],attrs:{id:"input-data-preview"}},[e._v("Input data preview")]),a("v-card-text",[e._v("As the transformation failed, here is the initial part of the input file to check if it is as you expect: "),a("v-sheet",{attrs:{color:"grey lighten-3 mt-1"}},[a("pre",{staticClass:"pa-2",staticStyle:{"white-space":"pre-wrap"}},[e._v(e._s(e.fileStart))])])],1)],1):e._e(),e.apiResponse?a("v-card",{staticClass:"mt-4",attrs:{id:"success"}},[a("v-alert",{attrs:{type:"success"}},[e._v("File Processed Successfully!")])],1):e._e(),e.apiResponse?a("v-card",{staticClass:"mt-4"},[a("v-card-title",{directives:[{name:"intersect",rawName:"v-intersect",value:e.onIntersect,expression:"onIntersect"}],attrs:{id:"tables-preview"}},[e._v("Tables Preview")]),a("v-card-text",[e._v(" Below is a preview of the tables that will be created. ")]),e._l(e.apiResponse.preview,(function(t){return a("v-container",{key:t.table_name},[a("v-card",{directives:[{name:"intersect",rawName:"v-intersect",value:e.onIntersect,expression:"onIntersect"}],attrs:{id:"table-"+t.table_name}},[a("v-card-title",{staticClass:"subtitle-1"},[e._v(" "+e._s(t.table_name)+" ")]),a("v-data-table",{attrs:{headers:e.fieldHeaders,items:t.fields,"item-key":"field_name","disable-pagination":"","hide-default-footer":""}})],1)],1)}))],2):e._e(),e.apiResponse?a("v-card",{staticClass:"mt-4",attrs:{id:"download"}},[a("v-container",[a("v-row",[a("v-col",[a("v-btn",{attrs:{color:"success",href:e.generateDownload("output.zip"),download:""}},[e._v("Download Full Zip")])],1),e.apiResponse.files["output.xlsx"]?a("v-col",[a("v-btn",{attrs:{color:"success",href:e.generateDownload("output.xlsx"),download:""}},[e._v("Download xlsx")])],1):e._e(),a("v-col",[a("v-btn",{attrs:{color:"success",href:e.generateDownload("fields.csv"),download:""}},[e._v("Download fields.csv")])],1),a("v-col",[a("v-btn",{attrs:{color:"success",href:e.generateDownload("tables.csv"),download:""}},[e._v("Download tables.csv")])],1),a("v-col",[a("v-btn",{attrs:{color:"success",href:e.generateDownload("datapackage.json"),download:""}},[e._v("Download datapackage.json")])],1)],1)],1)],1):e._e()],1)},S=[],k=a("1da1");a("96cf"),a("d81d"),a("2ca0"),a("159b"),a("b64b"),a("2b3d"),a("9861");function T(){return{panel:0,fileUpload:null,url:"",paste:"",useTitle:["No Title","Full Title","Slug","Underscore Slug"],arrayPosition:"top",array_key:"",path_separator:"",table_prefix:"",schemaTitle:"No Title",json_schema:"",main_table_name:"",inline_one_to_one:!1,fieldsUpload:null,fields_only:!1,tablesUpload:null,tables_only:!1,pushdown:"",id:"",formState:"new",fileStart:"",submitType:"",apiError:"",apiResponse:null,apiStatus:null,fieldHeaders:[{text:"Field Name",value:"field_title"},{text:"Field Type",value:"field_type"},{text:"Row Count",value:"count"},{text:"Value in first row",value:"row 0"},{text:"Value in second row",value:"row 1"},{text:"Value in third row",value:"row 2"}]}}var I={name:"Home",data:T,watch:{apiError:function(e){this.$store.commit("setSection",{name:"error",value:!!e})},apiResponse:function(e){var t=!1;e&&(t=e.preview.map((function(e){return e.table_name}))),this.$store.commit("setSection",{name:"tables",value:t})},formChanged:function(){this.formState="changed",this.id="",this.fileStart="",this.submitType="",this.apiError="",this.apiResponse=null,this.apiStatus=null}},computed:{formChanged:function(){return[this.panel,this.fileUpload,this.url,this.paste,this.arrayPosition,this.array_key,this.path_separator,this.table_prefix,this.schemaTitle,this.json_schema,this.main_table_name,this.inline_one_to_one,this.fieldsUpload,this.fields_only,this.tablesUpload,this.tables_only,this.pushdown]},submitButtonText:function(){var e={0:"Upload File and Preview",1:"Download URL and Preview",2:"Submit JSON and Preview"};return e[this.panel]},submitButtonDisabled:function(){var e={0:!!this.fileUpload,1:this.url.startsWith("http"),2:this.paste.length>5};return!e[this.panel]}},methods:{reset:function(){var e=this,t=T();Object.keys(t).forEach((function(a){return e[a]=t[a]})),this.$nextTick((function(){e.formState="new"}))},dataToParams:function(){var e={},t={"No Title":void 0,"Full Title":"full",Slug:"slug","Underscore Slug":"underscore_slug"}[this.schemaTitle];t&&(e.schema_titles=t);var a=["inline_one_to_one","main_table_name","table_prefix","path_separator","array_key","json_schema","fields_only","tables_only","pushdown"];for(var n in a){var s=a[n];this[s]&&(e[s]=this[s])}return"stream"==this.arrayPosition&&(e["json_lines"]=!0),"top"==this.arrayPosition&&(e["array_key"]=""),e},generateDownload:function(e){if(!this.apiResponse.files[e])return"";var t=new File([this.apiResponse.files[e].bytes],e);return URL.createObjectURL(t)},preview:function(){var e=this,t=this.dataToParams();t.output_format="preview";var a={0:this.upload,1:this.downloadURL,2:this.submitPaste};a[this.panel](t);var n=!this.fieldsUpload,s=!this.tablesUpload;if(n&&s&&a[this.panel](t),this.fieldsUpload){var i=new FileReader;i.onload=function(i){t.fields=i.target.result,n=!0,s&&(console.log(t),a[e.panel](t))},i.readAsText(this.fieldsUpload)}if(this.tablesUpload){var r=new FileReader;r.onload=function(i){t.tables=i.target.result,s=!0,n&&a[e.panel](t)},r.readAsText(this.tablesUpload)}},cleanStatus:function(){this.apiStatus=null,this.apiError=null,this.apiResponse=null,this.fileStart=null,this.formState="submitted"},upload:function(e){var t=this;this.cleanStatus();var a=new FileReader;a.onload=function(){var a=Object(k["a"])(regeneratorRuntime.mark((function a(n){var s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,window.wasm_bindgen.from_string(n.target.result,e);case 3:s=a.sent,t.apiResponse=s,console.log(t.apiResponse.preview),t.apiStatus=200,a.next=13;break;case 9:a.prev=9,a.t0=a["catch"](0),t.apiError=a.t0,t.apiStatus=400;case 13:case"end":return a.stop()}}),a,null,[[0,9]])})));return function(e){return a.apply(this,arguments)}}(),a.readAsText(this.fileUpload)},downloadURL:function(e){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.cleanStatus(),a.prev=1,a.next=4,window.wasm_bindgen.get_url(t.url,e);case 4:n=a.sent,t.apiResponse=n,t.apiStatus=200,a.next=13;break;case 9:a.prev=9,a.t0=a["catch"](1),t.apiError=a.t0,t.apiStatus=400;case 13:case"end":return a.stop()}}),a,null,[[1,9]])})))()},submitPaste:function(e){var t=this;return Object(k["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.cleanStatus(),a.prev=1,a.next=4,window.wasm_bindgen.from_string(t.paste,e);case 4:n=a.sent,t.apiResponse=n,t.apiStatus=200,a.next=13;break;case 9:a.prev=9,a.t0=a["catch"](1),t.apiError=a.t0,t.apiStatus=400;case 13:case"end":return a.stop()}}),a,null,[[1,9]])})))()},onIntersect:function(e){e[0].isIntersecting&&this.$store.commit("setListItem",e[0].target.id)}}},P=I,R=a("0798"),j=a("8336"),U=a("b0af"),V=a("99d9"),O=a("ac7c"),C=a("62ad"),D=a("a523"),E=a("8fea"),N=a("cd55"),L=a("49e2"),F=a("c865"),A=a("0393"),$=a("23a7"),J=a("490a"),B=a("67b6"),H=a("43a6"),M=a("0fd9"),q=a("8dd9"),G=a("8654"),z=a("a844"),K=a("269a"),W=a.n(K),Z=a("90a2"),Q=Object(l["a"])(P,g,S,!1,null,null,null),X=Q.exports;u()(Q,{VAlert:R["a"],VBtn:j["a"],VCard:U["a"],VCardText:V["a"],VCardTitle:V["b"],VCheckbox:O["a"],VCol:C["a"],VContainer:D["a"],VDataTable:E["a"],VExpansionPanel:N["a"],VExpansionPanelContent:L["a"],VExpansionPanelHeader:F["a"],VExpansionPanels:A["a"],VFileInput:$["a"],VProgressCircular:J["a"],VRadio:B["a"],VRadioGroup:H["a"],VRow:M["a"],VSheet:q["a"],VTextField:G["a"],VTextarea:z["a"]}),W()(Q,{Intersect:Z["a"]}),n["a"].use(y["a"]);var Y=[{path:"/",name:"Home",component:X},{path:"/about",name:"About",component:function(){return a.e("about").then(a.bind(null,"f820"))}}],ee=new y["a"]({mode:"history",base:"/",routes:Y}),te=ee,ae=a("f309");n["a"].use(ae["a"]);var ne=new ae["a"]({}),se=(a("b0c0"),a("2f62"));n["a"].use(se["a"]);var ie=new se["a"].Store({state:{sections:{error:!1,tables:!1},listItem:"json-input"},mutations:{setSection:function(e,t){this.state.sections[t.name]=t.value},setListItem:function(e,t){this.state.listItem=t}},actions:{},modules:{}});n["a"].config.productionTip=!1,new n["a"]({router:te,vuetify:ne,store:ie,render:function(e){return e(x)}}).$mount("#app")}});
//# sourceMappingURL=app.9b18beed.js.map